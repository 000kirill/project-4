import requests
from download_images import download_images
import os
from dotenv import load_dotenv


def main():
    api_key = os.environ.get("NASA_API_KEY")
    directory = os.environ.get("DIRECTORY")
    payload = {
            "api_key": api_key,
            "start_date": "2024-12-01",
            "end_date": "2024-12-29"
        }
    url = "https://api.nasa.gov/planetary/apod"
    response = requests.get(url, params=payload)
    response.raise_for_status()
    nasa_images = response.json()
    for i, nasa_image in enumerate(nasa_images):
        link = nasa_image["url"]
        extention = os.path.splitext(link)[1]
        path = os.path.join(directory, f"nasa{i}.jpg")
        download_images(link, path)
        

if __name__ == "__main__":
    main()

